<Window x:Class="ExcelBatchPdfExporter.Gui.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Excel Batch PDF Exporter" Height="640" Width="980"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="180"/>
        </Grid.RowDefinitions>

        <!-- Top controls -->
        <Border BorderBrush="#444" BorderThickness="1" CornerRadius="8" Padding="12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Inputs -->
                <StackPanel Grid.Column="0" Margin="0,0,12,0">
                    <TextBlock Text="Inputs" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <WrapPanel>
                        <Button Content="Add files..." Width="120" Margin="0,0,8,8" Click="AddFiles_Click"/>
                        <Button Content="Remove selected" Width="140" Margin="0,0,8,8" Click="RemoveFiles_Click"/>
                        <Button Content="Clear list" Width="120" Margin="0,0,8,8" Click="ClearFiles_Click"/>
                    </WrapPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                        <TextBlock Text="Global sheet index:" Width="130" VerticalAlignment="Center"/>
                        <TextBox x:Name="SheetIndexBox" Width="80" Text="2"/>
                        <TextBlock Text="(1-based)" Margin="10,0,0,0" VerticalAlignment="Center"/>
                    </StackPanel>

                    <Button Content="Inspect first file (show sheet names in log)"
                            Margin="0,10,0,0"
                            Height="30"
                            Click="InspectFirstFile_Click"/>
                </StackPanel>

                <!-- Output -->
                <StackPanel Grid.Column="1">
                    <TextBlock Text="Output" FontWeight="SemiBold" Margin="0,0,0,8"/>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <Button Content="Choose output folder..."
                                Width="180"
                                Click="BrowseOutput_Click"/>
                        <TextBlock Text=" " Width="10"/>
                        <TextBlock x:Name="OutputFolderText"
                                   VerticalAlignment="Center"
                                   Text="(not set — using input folders)"
                                   TextWrapping="Wrap"/>
                    </StackPanel>

                    <CheckBox x:Name="UseOutputFolderCheck"
                              Content="Use output folder above (otherwise save next to each input file)"
                              IsChecked="False"/>

                    <CheckBox x:Name="OverwriteCheck"
                              Content="Overwrite if PDF exists"
                              Margin="0,6,0,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- File list -->
        <Grid Grid.Row="1" Margin="0,12,0,12">
            <Border BorderBrush="#444" BorderThickness="1" CornerRadius="8" Padding="12">
                <DockPanel>
                    <TextBlock DockPanel.Dock="Top" Text="Files (batch conversion uses ALL files in this list)" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <ListBox x:Name="FilesList" SelectionMode="Extended"/>
                </DockPanel>
            </Border>
        </Grid>

        <!-- Actions -->
        <Grid Grid.Row="2" Margin="0,0,0,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock x:Name="StatusText" VerticalAlignment="Center"/>

            <Button Grid.Column="1"
                    Content="Convert ALL files (global sheet index)"
                    Width="300"
                    Height="36"
                    Click="ConvertAll_Click"/>
        </Grid>

        <!-- Log -->
        <Border Grid.Row="3" BorderBrush="#444" BorderThickness="1" CornerRadius="8" Padding="12">
            <DockPanel>
                <TextBlock DockPanel.Dock="Top" Text="Log" FontWeight="SemiBold" Margin="0,0,0,8"/>
                <TextBox x:Name="LogBox" IsReadOnly="True" VerticalScrollBarVisibility="Auto" TextWrapping="Wrap"/>
            </DockPanel>
        </Border>
    </Grid>
</Window>
